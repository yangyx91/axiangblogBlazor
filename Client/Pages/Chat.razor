@page "/chat"
@using Microsoft.AspNetCore.Authorization
@using Microsoft.Graph
@attribute [Authorize]
@inject GraphServiceClient GraphClient
@inject HttpClient http

<iframe src="https://axiangchat.azurewebsites.net?userId=@user.Id&@user.UserPrincipalName" frameborder="0" style="width: 100%; height: 100%;"></iframe>

@code {

    private User user;

    protected override async Task OnInitializedAsync() //actions to do when the page is initialized
    {
        var request = GraphClient.Me.Request();
        user = await request.GetAsync();
    }
}